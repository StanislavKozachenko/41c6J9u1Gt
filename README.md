# StoryValut app

Позволяет пользователям оставлять сообщения, редактировать и удалять их через ссылки, приходящие на e-mail.  
Проект полностью готов для развёртывания в **Docker**.

Сруктура папок
-------------------

    assets/             содержит определения ассетов (ресурсов)
    commands/           содержит консольные команды (контроллеры)
    config/             содержит файлы конфигурации приложения
    controllers/        содержит классы веб-контроллеров
    mail/               содержит шаблоны писем (view-файлы для e-mail)
    messages/           содержит файл класса менеджера сообщений
    migrations/         содержит файлы миграций
    models/             содержит классы моделей
    runtime/            содержит файлы, создаваемые во время выполнения приложения
    tests/              содержит различные тесты приложения
    vendor/             содержит сторонние зависимости (пакеты)
    views/              содержит view-файлы (представления) веб-приложения
    web/                содержит входной скрипт и веб-ресурсы (доступные пользователю)

Требования
------------

- Минимальное требование этого шаблона проекта - чтобы ваш веб-сервер поддерживал PHP 7.4.
- Минимальная требуемая версия Docker engine для разработки 17.04.

---

## Установка и запуск проекта

### 1. Клонируйте репозиторий

```bash
https://github.com/StanislavKozachenko/41c6J9u1Gt.git
cd 41c6J9u1Gt
```

---

### 2. Установите зависимости через Composer

Обновите пакеты

```bash
docker-compose run --rm php composer update --prefer-dist

docker-compose run --rm php composer install
```

---

### 3. Запустите контейнеры

```bash
docker-compose up -d
```

После этого будут запущены:

- **PHP + Nginx** — основной сервер приложения
- **MySQL** — база данных
- **phpMyAdmin** — панель управления БД

---

### 4. Примените миграции базы данных

```bash
docker exec -it yii2_php php yii migrate
```

При появлении вопроса — подтвердите действие, введя `yes`.

---

### 5. Готово!

Откройте проект в браузере:

- Сайт: [http://localhost:8080](http://localhost:8080)
- phpMyAdmin: [http://localhost:8081](http://localhost:8081)  
  (логин/пароль указываются в `.env` или `docker-compose.yml`)

---

#### Права веб-процесса

В некоторых окружениях (например, при работе в Docker, WSL или на удалённом сервере) веб-процесс может не иметь прав на
запись в директории `'runtime'` и `'web/assets'`.
Если при запуске проекта появляются ошибки, связанные с невозможностью записи или кэширования, необходимо выдать права
вручную:

```bash
sudo chmod -R 777 runtime web/assets
```

- Эта команда даёт полные права на запись для всех пользователей и подходит только для **локальной разработки**.

В продакшене рекомендуется назначать права более безопасно (например, только пользователю веб-сервера).

---

## Проверка писем

Все письма (ссылки на редактирование/удаление постов) сохраняются в виде файлов `.eml`.  
Чтобы просмотреть их корректно, используйте любую программу, поддерживающую `.eml`, например:

- **Thunderbird**
- **Microsoft Outlook**
